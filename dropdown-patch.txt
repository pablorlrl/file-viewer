// Patch to add dropdown functionality
// This file will be used to apply changes to app-ace.js

// 1. Add currentFontSize variable after line 14 (after hasUnsavedChanges)
// INSERT: let currentFontSize = 14;

// 2. Add dropdown DOM elements to els object (after line 26, before closing brace)
// INSERT:
//     btnTools: document.getElementById('btnTools'),
//     dropdownTools: document.getElementById('dropdownTools'),
//     btnSettings: document.getElementById('btnSettings'),
//     dropdownSettings: document.getElementById('dropdownSettings'),
//     btnFontInc: document.getElementById('btnFontInc'),
//     btnFontDec: document.getElementById('btnFontDec'),
//     fontSizeDisplay: document.getElementById('fontSizeDisplay')

// 3. Change line 135 from fontSize: "14px" to fontSize: `${currentFontSize}px`

// 4. Add at end of file (after line 633):
// --- Tools & Settings Dropdowns ---

function toggleDropdown(dropdown) {
    // Close all other dropdowns
    document.querySelectorAll('.dropdown-content').forEach(el => {
        if (el !== dropdown) el.classList.remove('show');
    });
    dropdown.classList.toggle('show');
}

els.btnTools.addEventListener('click', (e) => {
    e.stopPropagation();
    toggleDropdown(els.dropdownTools);
});

els.btnSettings.addEventListener('click', (e) => {
    e.stopPropagation();
    toggleDropdown(els.dropdownSettings);
});

// Close dropdowns when clicking outside
document.addEventListener('click', (e) => {
    if (!e.target.closest('.dropdown')) {
        document.querySelectorAll('.dropdown-content').forEach(el => el.classList.remove('show'));
    }
});

// Font Size Control
function updateFontSize(change) {
    currentFontSize += change;
    if (currentFontSize < 8) currentFontSize = 8;
    if (currentFontSize > 32) currentFontSize = 32;

    els.fontSizeDisplay.textContent = `${currentFontSize}px`;
    if (editor) {
        editor.setOptions({ fontSize: `${currentFontSize}px` });
    }
}

els.btnFontInc.addEventListener('click', (e) => {
    e.stopPropagation();
    updateFontSize(1);
});

els.btnFontDec.addEventListener('click', (e) => {
    e.stopPropagation();
    updateFontSize(-1);
});
